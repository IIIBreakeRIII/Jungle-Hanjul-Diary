<!DOCTYPE html>
<html lang="ko">
	<head>
		<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>My-Diary | Hanjul-Diary</title>
    <link href="{{ url_for('static', filename='css/tailwind.css') }}" rel="stylesheet">
	</head>

  <body class="bg-[rgba(var(--bg-orange))]">
    <main class="min-h-screen flex flex-col justify-center">
			<section class="flex justify-center">
        <div class="logo flex flex-row items-center pb-[20px]">
          <img src="{{ url_for('static', filename='logo.png') }}" class="w-[140px] max-[720px]:w-[100px] object-contain" />
          <p class="text-[40px] max-[720px]:text-[28px] font-[500] text-center">일기, 한마디</p>
        </div>
      </section> 

      <section>
        <div class="menu-myDiary-main-div mx-[90px] max-[720px]:mx-[40px] shadow-div-parent p-8 rounded-[12px] flex flex-col">
          <div class="pt-[20px] pb-[20px] text-[20px] font-[500] text-center">
            <span>내가 쓴 일기</span>
          </div>
          <form id="searchForm" action="{{ url_for('search_diary') }}" method="GET" class="diary-search-div mt-[20px] flex items-center">
            <input type="text" placeholder="검색할 일기" maxlength="30" class="diary-search-input flex-1 bg-[rgba(var(--bg-orange))] shadow-div-parent border rounded-[8px] px-3 py-2 focus:outline-[rgba(var(--primary))]"/>
            <button type="submit" class="diary-search-button text-[rgba(var(--black))] ml-[12px] px-[20px] max-[540px]:px-[12px] py-2 shadow-div-parent border rounded-[8px] hover:border-primary">
              검색
            </button>
          </form>
          <div class="my-diary-list flex flex-col items-center w-full max-w-[500px] mx-auto">
            {% if my_diaries %}
              {% for diary in my_diaries %}
                <a href="{{ url_for('edit_diary', diary_id=diary._id) }}" class="w-full">
                  <button class="my-diary-button w-full text-[16px] font-[100] text-[rgba(var(--black))] mt-[20px] py-[12px] px-[12px] shadow-div-parent border rounded-[8px] hover:border-primary truncate overflow-hidden whitespace-nowrap">
                    {{ diary.content }}
                  </button>
                </a>
              {% endfor %}
            {% else %}
                <p class="mt-[20px] text-center text-gray-500">작성한 일기가 없습니다.</p>
            {% endif %}
          </div>
        </div>
        <div class="mx-[90px] max-[720px]:mx-[40px]">
          <a href="{{ url_for('show_main_page') }}">
            <button class="mt-[20px] py-[16px] max-[720px]:py-[10px] shadow-div-parent text-[18px] font-[200] border rounded-[12px] hover:border-primary w-full">
              메뉴화면으로 돌아가기
            </button>
          </a>
        </div>
      </section>
    </main>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const searchForm = document.getElementById('searchForm');

        searchForm.addEventListener('submit', async (e) => {
            e.preventDefault(); // 폼의 기본 제출 동작을 막습니다

            const keywordEl = document.querySelector('.diary-search-input');
            const keyword = keywordEl.value;

            // GET 요청으로 변경
            window.location.href = `/api/diary/search?keyword=${encodeURIComponent(keyword)}`;
        });
    });

    </script>
  </body>
</html>
